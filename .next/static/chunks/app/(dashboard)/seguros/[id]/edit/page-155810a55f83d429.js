(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[538],{8651:(e,s,l)=>{Promise.resolve().then(l.bind(l,9289))},9289:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>q});var a=l(5155),i=l(3312),n=l(9749),t=l(3473),r=l(5686),d=l(3580),c=l(4505),o=l(3900),x=l(4877),u=l(5828);let m=(0,u.createServerReference)("400dab3a5ab38492d6e97123af7a435113bf7752b2",u.callServer,void 0,u.findSourceMapURL,"GET_INSURE_ID");var p=l(1800),f=l(7974);let h=(0,u.createServerReference)("40a9fecad002339a8ca6e6eb21d6ad5bda7910ea6a",u.callServer,void 0,u.findSourceMapURL,"PUT_INSURE_UNIQUE");var j=l(7995),g=l(9130),v=l(2115),b=l(4698),N=l(7528),y=l(547),S=l(5848),w=l(2776),C=l(6096),_=l(7749),A=l(5037),z=l(9173);function q(e){let{params:s}=e,l=v.use(s),[u,q]=(0,v.useState)(l.id),[I,$]=(0,v.useState)([]),[k,D]=(0,v.useState)([]),[U,P]=(0,v.useState)([]),[R,T]=(0,v.useState)(""),[F,G]=(0,v.useState)(""),[K,O]=(0,v.useState)(""),{data:V,isPending:L}=(0,y.I)({queryKey:["get-tipo-apolice"],queryFn:x.D}),{data:M,isPending:Q}=(0,y.I)({queryKey:["get-insure-id",u],queryFn:e=>{let{queryKey:s}=e;return m(s[1])}}),{data:W,isPending:Z}=(0,y.I)({queryKey:["get-categories"],queryFn:p.g}),{data:B,isPending:H}=(0,y.I)({queryKey:["get-apolice-type"],queryFn:f.a});function J(e,s){return e.find(e=>e.id.toString()===s)}let{mutateAsync:X,isPending:Y}=(0,S.n)({mutationFn:h,onSuccess:e=>{A.Ay.success("Seguro editado com sucesso")},onError:e=>{console.log("Error")}});(0,v.useEffect)(()=>{M&&(T(M.name),G(M.description.toString().replace(/"/g,"")),$(M.policy_types),D(M.insurance_types),P(M.categories),es(M.option_groups))},[M]);let[ee,es]=(0,v.useState)([]);function el(e){es(ee.filter(s=>{var l;return(null===(l=s.id)||void 0===l?void 0:l.toString())!=e}))}async function ea(e){if(e.preventDefault(),""===R){O("O nome \xe9 obrigat\xf3rio");return}await X({name:R,id:u,description:F,policy_type_ids:I.map(e=>e.id),insurance_type_ids:k.map(e=>e.id),category_ids:U.map(e=>e.id),option_groups:ee})}return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("div",{className:"flex items-end justify-between gap-2",children:(0,a.jsx)("div",{className:" flex flex-col items-start w-full justify-start max-w-lg r",children:(0,a.jsx)("h1",{className:"text-zinc-800 font-extrabold text-lg",children:"Editar Seguro"})})}),Y?(0,a.jsx)(E,{}):(0,a.jsx)(n.Zp,{children:(0,a.jsx)(n.Wu,{children:(0,a.jsx)(j.ScrollArea,{className:"md:w-[calc(100vw-350px)]",children:(0,a.jsxs)("form",{onSubmit:ea,children:[(0,a.jsxs)("div",{className:"my-4 flex flex-col gap-2",children:[(0,a.jsxs)("fieldset",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"font-bold text-zinc-800 text-sm",children:"Seguro"}),(0,a.jsx)(o.p,{value:R,onChange:function(e){e.target.value&&O(""),T(e.target.value)},className:"",placeholder:"Insira o nome do seguro"}),K&&(0,a.jsx)("span",{className:"text-red-700",children:"O nome \xe9 obrigat\xf3rio"})]}),(0,a.jsxs)("fieldset",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"font-bold text-zinc-800 text-sm",children:"Descri\xe7\xe3o"}),(0,a.jsx)(o.p,{className:"max-w-lg w-full",value:F,onChange:e=>G(e.target.value),placeholder:"Insira a descri\xe7\xe3o do seguro"})]}),(0,a.jsx)("div",{className:"h-[1px] rounded-full bg-zinc-300 w-full"}),(0,a.jsx)("br",{}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 items-start",children:[(0,a.jsxs)("fieldset",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"font-bold text-zinc-800 text-sm",children:"Tipo de Apolice"}),(0,a.jsxs)("div",{className:"w-full flex   items-center gap-2",children:[(0,a.jsxs)(N.l6,{onValueChange:e=>(function(e){if(J(I,e))return;let s=B.find(s=>s.id.toString()===e);s&&$([...I,s])})(e),children:[(0,a.jsx)(N.bq,{className:"flex-1",children:(0,a.jsx)(N.yv,{placeholder:"Selecione o grupo"})}),(0,a.jsx)(N.gC,{children:null==B?void 0:B.map(e=>(0,a.jsx)(N.eb,{value:e.id.toString(),children:e.name},e.id))})]}),(0,a.jsx)(C.DialogSaveApoliceType,{children:(0,a.jsx)(i.$,{type:"button",title:"Cadastrar grupo",className:"p-0 w-8 h-8 rounded-full",children:(0,a.jsx)(t.A,{})})})]}),(null==I?void 0:I.length)>0?(0,a.jsx)("div",{className:"w-full flex flex-col gap-2 text-sm border shadow p-2 rounded-md",children:null==I?void 0:I.map(e=>(0,a.jsxs)("li",{className:"flex border-b pb-1 last:pb-0 last:border-0 justify-between items-center",children:[(0,a.jsx)("span",{children:e.name})," ",(0,a.jsx)(i.$,{type:"button",onClick:()=>{var s;return s=e.id,void $(I.filter(e=>e.id.toString()!=s))},size:"sm",className:"p-0 px-2",variant:"outline",children:(0,a.jsx)(r.A,{})})]},e.id))}):(0,a.jsx)("span",{className:"text-xs font-bold",children:"Nenhum tipo de apolice selecionado"})]}),(0,a.jsxs)("fieldset",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"font-bold text-zinc-800 text-sm",children:"Tipo de seguro"}),(0,a.jsxs)("div",{className:"w-full flex   items-center gap-2",children:[(0,a.jsxs)(N.l6,{onValueChange:e=>(function(e){if(J(k,e))return;let s=V.find(s=>s.id.toString()===e);s&&D([...k,s])})(e),children:[(0,a.jsx)(N.bq,{className:"flex-1",children:(0,a.jsx)(N.yv,{placeholder:"Selecione o grupo"})}),(0,a.jsx)(N.gC,{children:null==V?void 0:V.map(e=>(0,a.jsx)(N.eb,{value:e.id.toString(),children:e.name},e.id))})]}),(0,a.jsx)(_.DialogSavaInsureType,{children:(0,a.jsx)(i.$,{title:"Cadastrar grupo",className:"p-0 w-8 h-8 rounded-full",children:(0,a.jsx)(t.A,{})})})]}),(null==k?void 0:k.length)>0?(0,a.jsx)("div",{className:"w-full flex flex-col gap-2 text-sm border shadow p-2 rounded-md",children:null==k?void 0:k.map(e=>(0,a.jsxs)("li",{className:"flex last:pb-0 border-b pb-1 last:border-0 justify-between items-center",children:[(0,a.jsx)("span",{children:e.name})," ",(0,a.jsx)(i.$,{type:"button",onClick:()=>{var s;return s=e.id,void D(k.filter(e=>{var l;return(null===(l=e.id)||void 0===l?void 0:l.toString())!=s}))},size:"sm",className:"p-0 px-2",variant:"outline",children:(0,a.jsx)(r.A,{})})]},e.id))}):(0,a.jsx)("span",{className:"text-xs font-bold",children:"Nenhum tipo de seguro selecionado"})]})]}),(0,a.jsx)("br",{}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 items-start",children:(0,a.jsxs)("fieldset",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"font-bold text-zinc-800 text-sm",children:"Categoria"}),(0,a.jsxs)("div",{className:"w-full flex   items-center gap-2",children:[(0,a.jsxs)(N.l6,{onValueChange:e=>(function(e){if(J(U,e))return;let s=W.find(s=>s.id.toString()===e);s&&P([...U,s])})(e),children:[(0,a.jsx)(N.bq,{className:"flex-1",children:(0,a.jsx)(N.yv,{placeholder:"Selecione o grupo"})}),(0,a.jsx)(N.gC,{children:null==W?void 0:W.map(e=>(0,a.jsx)(N.eb,{value:e.id.toString(),children:e.name},e.id))})]}),(0,a.jsx)(w.DialogSaveCategory,{children:(0,a.jsx)(i.$,{type:"button",title:"Cadastrar grupo",className:"p-0 w-8 h-8 rounded-full",children:(0,a.jsx)(t.A,{})})})]}),(null==U?void 0:U.length)>0?(0,a.jsx)("div",{className:"w-full flex flex-col gap-2 text-sm border shadow p-2 rounded-md",children:null==U?void 0:U.map(e=>(0,a.jsxs)("li",{className:"flex border-b pb-1 last:pb-0 last:border-0 justify-between items-center",children:[(0,a.jsx)("span",{children:e.name})," ",(0,a.jsx)(i.$,{type:"button",onClick:()=>{var s;return s=e.id,void P(U.filter(e=>{var l;return(null===(l=e.id)||void 0===l?void 0:l.toString())!=s}))},size:"sm",className:"p-0 px-2",variant:"outline",children:(0,a.jsx)(r.A,{})})]},e.id))}):(0,a.jsx)("span",{className:"text-xs font-bold",children:"Nenhuma categoria selecionada"})]})}),(0,a.jsx)("br",{}),(0,a.jsx)("div",{className:"h-[1px] rounded-full bg-zinc-300 w-full"}),(0,a.jsxs)("fieldset",{className:"flex flex-col gap-1 max-w-lg w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h1",{children:"Grupo de op\xe7\xf5es"}),(0,a.jsx)(z.n,{groups:ee,setGroups:es,children:(0,a.jsx)(i.$,{className:"p-0 w-8 h-8 rounded-full",children:(0,a.jsx)(d.A,{})})})]}),(0,a.jsx)(g.nD,{type:"single",collapsible:!0,children:null==ee?void 0:ee.map(e=>(0,a.jsxs)(g.As,{value:e.id,children:[(0,a.jsxs)(g.$m,{className:"text-sm font-semibold text-zinc-800",children:[(0,a.jsxs)(b.Q,{removeGroup:el,group_id:e.id,children:[e.name," "]}),"    "]}),(0,a.jsxs)(g.ub,{className:"flex flex-col gap-2",children:[null==e?void 0:e.options.map(s=>(0,a.jsxs)("li",{className:"flex items-center justify-between text-sm text-zinc-600 shadow border rounded-sm p-2",children:[(0,a.jsxs)("span",{children:[" ",s.name]}),(0,a.jsx)(i.$,{onClick:()=>(function(e,s){console.log(e,s);let l=ee.map(l=>{if(l.id==e){let e=l.options.filter(e=>e.name!=s);return console.log(e),{...l,options:e}}return l});console.log(l),es(l)})(e.id,s.name),type:"button",variant:"outline",size:"sm",children:(0,a.jsx)(r.A,{})})]},s.name)),0===e.options.length&&(0,a.jsx)("p",{className:"text-zinc-600 text-sm",children:"Nenhuma cobertura cadastrada"})]})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex  justify-end gap-2",children:[(0,a.jsx)(i.$,{variant:"outline",children:"Cancelar"}),(0,a.jsxs)(i.$,{disabled:Y,className:"text-white bg-orange-600 hover:bg-orange-700 flex items-center",children:["Salvar ",Y&&(0,a.jsx)(c.A,{className:"animate-spin"})]})]})]})})})})]})}function E(){return(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)(c.A,{className:"animate-spin",width:48})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[963,6791,5037,1469,8239,4009,6577,8685,7317,6173,8996,4543,1333,2493,8441,1517,7358],()=>s(8651)),_N_E=e.O()}]);